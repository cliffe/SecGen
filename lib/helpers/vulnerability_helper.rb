require_relative '../objects/vulnerability.rb'
require_relative '../constants.rb'

class VulnerabilityHelper
  # Assign all values to a new vulnerability object
  # @param vulnerability_hash [Hash]
  # @return [Object] Vulnerability object containing all available values
  def getVulnerabilityObject(vulnerability_hash)
    vulnerability = Vulnerability.new
    vulnerability.attributes[:type] ||= vulnerability_hash['type']
    vulnerability.attributes[:privilege] ||= vulnerability_hash['privilege']
    vulnerability.attributes[:access] ||= vulnerability_hash['access']
    vulnerability.attributes[:puppets] ||= vulnerability_hash['puppets']
    vulnerability.attributes[:details] ||= vulnerability_hash['details']
    vulnerability.attributes[:ports] ||= vulnerability_hash['ports']
    vulnerability.attributes[:platform] ||= vulnerability_hash['platform']
    vulnerability.attributes[:name] ||= vulnerability_hash['name']
    vulnerability.attributes[:cve] ||= vulnerability_hash['cve']
    vulnerability.attributes[:files] ||= vulnerability_hash['files']
    vulnerability.attributes[:scripts] ||= vulnerability_hash['scripts']
    vulnerability.attributes[:difficulty] ||= vulnerability_hash['difficulty']
    vulnerability.attributes[:cvss_rating] ||= vulnerability_hash['cvss_rating']
    vulnerability.attributes[:cvss_score] ||= vulnerability_hash['cvss_score']
    vulnerability.attributes[:vector_string] ||= vulnerability_hash['vector_string']
    return vulnerability
  end
end