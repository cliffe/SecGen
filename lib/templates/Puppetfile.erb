#!/usr/bin/env ruby
#^syntax detection

# This file was generated by SecGen
# <%= @time %>
# Based on <%= @scenario %>
# These modules are for system: <%= @currently_processing_system.name %>

forge "https://forgeapi.puppetlabs.com"

mod 'puppetlabs-stdlib', '4.6.0'  # stdlib enables parsejson() in manifests and other useful functions
mod 'puppetlabs-powershell', '2.1.0'
mod 'puppetlabs-registry', '1.0.0'
mod 'SecGen-secgen_functions', :path => '<%= SECGEN_FUNCTIONS_PUPPET_DIR %>'

<% @currently_processing_system.module_selections.each do |selected_module| -%>
<%   case selected_module.module_type
       when 'vulnerability', 'service', 'utility', 'build', 'forensic' -%>
mod 'SecGen-<%= selected_module.module_path_name %>/<%= selected_module.module_path_end %>', :path => '<%="#{ROOT_DIR}/#{selected_module.module_path}"%>'
<%   end -%>
<%  end -%>
